'use strict';

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

var _createClass = function () {
  function defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if ("value" in descriptor) descriptor.writable = true;Object.defineProperty(target, descriptor.key, descriptor);
    }
  }return function (Constructor, protoProps, staticProps) {
    if (protoProps) defineProperties(Constructor.prototype, protoProps);if (staticProps) defineProperties(Constructor, staticProps);return Constructor;
  };
}();

function _classCallCheck(instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
}

function _possibleConstructorReturn(self, call) {
  if (!self) {
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  }return call && ((typeof call === "undefined" ? "undefined" : _typeof(call)) === "object" || typeof call === "function") ? call : self;
}

function _inherits(subClass, superClass) {
  if (typeof superClass !== "function" && superClass !== null) {
    throw new TypeError("Super expression must either be null or a function, not " + (typeof superClass === "undefined" ? "undefined" : _typeof(superClass)));
  }subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } });if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
}

var Wrapper = function (_React$Component) {
  _inherits(Wrapper, _React$Component);

  function Wrapper() {
    _classCallCheck(this, Wrapper);

    return _possibleConstructorReturn(this, (Wrapper.__proto__ || Object.getPrototypeOf(Wrapper)).apply(this, arguments));
  }

  _createClass(Wrapper, [{
    key: 'render',
    value: function render() {
      return React.createElement('div', null, this.props.children);
    }
  }]);

  return Wrapper;
}(React.Component);

describe('FishTable', function () {

  it('should render no `FishTableRow` when given zero fish', function () {
    // The Wraper allows us to scry for components
    var fishTable = React.addons.TestUtils.renderIntoDocument(React.createElement(Wrapper, null, React.createElement(FishTable, { fishes: [] })));

    var fishTableRows = React.addons.TestUtils.scryRenderedComponentsWithType(fishTable, FishTableRow);
    fishTableRows.should.have.length(0);
  });

  it('should render one `FishTableRow` when given one fish', function () {
    var fishData = [{
      name: 'Goldfish',
      image: 'http://tinyurl.com/n4vgcl5',
      description: 'Everyone\'s first pet'
    }];

    // The Wraper allows us to scry for components
    var fishTable = React.addons.TestUtils.renderIntoDocument(React.createElement(Wrapper, null, React.createElement(FishTable, { fishes: fishData })));

    var fishTableRows = React.addons.TestUtils.scryRenderedComponentsWithType(fishTable, FishTableRow);
    fishTableRows.should.have.length(1);
  });

  it('should render three `FishTableRow` when given three fishes', function () {
    var fishData = [{
      name: 'Goldfish',
      image: 'http://tinyurl.com/n4vgcl5',
      description: 'Everyone\'s first pet'
    }, {
      name: 'Pufferfish',
      image: 'http://tinyurl.com/kxd7cuu',
      description: 'So puffy!'
    }, {
      name: 'Tuna',
      image: 'http://tinyurl.com/zgs7z2s',
      description: 'Why are these things so huge? THey\'re terrifying.'
    }];

    // The Wraper allows us to scry for components
    var fishTable = React.addons.TestUtils.renderIntoDocument(React.createElement(Wrapper, null, React.createElement(FishTable, { fishes: fishData })));

    var fishTableRows = React.addons.TestUtils.scryRenderedComponentsWithType(fishTable, FishTableRow);
    fishTableRows.should.have.length(3);
  });
});

describe('FishTableRow', function () {
  it('should render a dynamic name', function () {
    var blobbert = {
      name: 'Blobbert',
      image: 'http://tinyurl.com/hfhonhc',
      description: 'The saddest blob of a fish you have ever seen'
    };

    var fishTableRow = ReactDOM.render(React.createElement(FishTableRow, { fish: blobbert }), document.createElement('tbody'));

    var name = React.addons.TestUtils.findRenderedDOMComponentWithClass(fishTableRow, 'fish-name');
    name.innerText.should.equal('Blobbert');
  });

  it('should render a dynamic image', function () {
    var blobbert = {
      name: 'Blobbert',
      image: 'http://tinyurl.com/hfhonhc',
      description: 'The saddest blob of a fish you have ever seen'
    };

    var fishTableRow = ReactDOM.render(React.createElement(FishTableRow, { fish: blobbert }), document.createElement('tbody'));

    var image = React.addons.TestUtils.findRenderedDOMComponentWithTag(fishTableRow, 'img');
    image.src.should.equal('http://tinyurl.com/hfhonhc');
  });

  it('should render a dynamic description', function () {
    var blobbert = {
      name: 'Blobbert',
      image: 'http://tinyurl.com/hfhonhc',
      description: 'The saddest blob of a fish you have ever seen'
    };

    var fishTableRow = ReactDOM.render(React.createElement(FishTableRow, { fish: blobbert }), document.createElement('tbody'));

    // Toggle description on before we search for it
    fishTableRow.setState({ showDescription: true });

    var description = React.addons.TestUtils.findRenderedDOMComponentWithClass(fishTableRow, 'fish-description');
    description.innerText.should.equal('The saddest blob of a fish you have ever seen');
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3JlYWN0LXBvbmQvcmVhY3QtcG9uZC50ZXN0LmpzIl0sIm5hbWVzIjpbIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJDb25zdHJ1Y3RvciIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiVHlwZUVycm9yIiwiX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iLCJzZWxmIiwiY2FsbCIsIlJlZmVyZW5jZUVycm9yIiwiX2luaGVyaXRzIiwic3ViQ2xhc3MiLCJzdXBlckNsYXNzIiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJ2YWx1ZSIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiV3JhcHBlciIsIl9SZWFjdCRDb21wb25lbnQiLCJnZXRQcm90b3R5cGVPZiIsImFwcGx5IiwiYXJndW1lbnRzIiwicmVuZGVyIiwiUmVhY3QiLCJjcmVhdGVFbGVtZW50IiwiY2hpbGRyZW4iLCJDb21wb25lbnQiLCJkZXNjcmliZSIsIml0IiwiZmlzaFRhYmxlIiwiYWRkb25zIiwiVGVzdFV0aWxzIiwicmVuZGVySW50b0RvY3VtZW50IiwiRmlzaFRhYmxlIiwiZmlzaGVzIiwiZmlzaFRhYmxlUm93cyIsInNjcnlSZW5kZXJlZENvbXBvbmVudHNXaXRoVHlwZSIsIkZpc2hUYWJsZVJvdyIsInNob3VsZCIsImhhdmUiLCJmaXNoRGF0YSIsIm5hbWUiLCJpbWFnZSIsImRlc2NyaXB0aW9uIiwiYmxvYmJlcnQiLCJmaXNoVGFibGVSb3ciLCJSZWFjdERPTSIsImZpc2giLCJkb2N1bWVudCIsImZpbmRSZW5kZXJlZERPTUNvbXBvbmVudFdpdGhDbGFzcyIsImlubmVyVGV4dCIsImVxdWFsIiwiZmluZFJlbmRlcmVkRE9NQ29tcG9uZW50V2l0aFRhZyIsInNyYyIsInNldFN0YXRlIiwic2hvd0Rlc2NyaXB0aW9uIl0sIm1hcHBpbmdzIjoiQUFBQTs7OztBQUVBLElBQUlBLGVBQWUsWUFBWTtBQUFFLFdBQVNDLGdCQUFULENBQTBCQyxNQUExQixFQUFrQ0MsS0FBbEMsRUFBeUM7QUFBRSxTQUFLLElBQUlDLElBQUksQ0FBYixFQUFnQkEsSUFBSUQsTUFBTUUsTUFBMUIsRUFBa0NELEdBQWxDLEVBQXVDO0FBQUUsVUFBSUUsYUFBYUgsTUFBTUMsQ0FBTixDQUFqQixDQUEyQkUsV0FBV0MsVUFBWCxHQUF3QkQsV0FBV0MsVUFBWCxJQUF5QixLQUFqRCxDQUF3REQsV0FBV0UsWUFBWCxHQUEwQixJQUExQixDQUFnQyxJQUFJLFdBQVdGLFVBQWYsRUFBMkJBLFdBQVdHLFFBQVgsR0FBc0IsSUFBdEIsQ0FBNEJDLE9BQU9DLGNBQVAsQ0FBc0JULE1BQXRCLEVBQThCSSxXQUFXTSxHQUF6QyxFQUE4Q04sVUFBOUM7QUFBNEQ7QUFBRSxHQUFDLE9BQU8sVUFBVU8sV0FBVixFQUF1QkMsVUFBdkIsRUFBbUNDLFdBQW5DLEVBQWdEO0FBQUUsUUFBSUQsVUFBSixFQUFnQmIsaUJBQWlCWSxZQUFZRyxTQUE3QixFQUF3Q0YsVUFBeEMsRUFBcUQsSUFBSUMsV0FBSixFQUFpQmQsaUJBQWlCWSxXQUFqQixFQUE4QkUsV0FBOUIsRUFBNEMsT0FBT0YsV0FBUDtBQUFxQixHQUFoTjtBQUFtTixDQUE5aEIsRUFBbkI7O0FBRUEsU0FBU0ksZUFBVCxDQUF5QkMsUUFBekIsRUFBbUNMLFdBQW5DLEVBQWdEO0FBQUUsTUFBSSxFQUFFSyxvQkFBb0JMLFdBQXRCLENBQUosRUFBd0M7QUFBRSxVQUFNLElBQUlNLFNBQUosQ0FBYyxtQ0FBZCxDQUFOO0FBQTJEO0FBQUU7O0FBRXpKLFNBQVNDLDBCQUFULENBQW9DQyxJQUFwQyxFQUEwQ0MsSUFBMUMsRUFBZ0Q7QUFBRSxNQUFJLENBQUNELElBQUws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Q0FBbkI7O0FBRUE7QUFDQXFCLGlCQUFhUyxRQUFiLENBQXNCLEVBQUVDLGlCQUFpQixJQUFuQixFQUF0Qjs7QUFFQSxRQUFJWixjQUFjcEIsTUFBTU8sTUFBTixDQUFhQyxTQUFiLENBQXVCa0IsaUNBQXZCLENBQXlESixZQUF6RCxFQUF1RSxrQkFBdkUsQ0FBbEI7QUFDQUYsZ0JBQVlPLFNBQVosQ0FBc0JaLE1BQXRCLENBQTZCYSxLQUE3QixDQUFtQywrQ0FBbkM7QUFDRCxHQWREO0FBZUQsQ0ExQ0QiLCJmaWxlIjoicmVhY3QtcG9uZC50ZXN0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbnZhciBXcmFwcGVyID0gZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHtcbiAgX2luaGVyaXRzKFdyYXBwZXIsIF9SZWFjdCRDb21wb25lbnQpO1xuXG4gIGZ1bmN0aW9uIFdyYXBwZXIoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFdyYXBwZXIpO1xuXG4gICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChXcmFwcGVyLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoV3JhcHBlcikpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKFdyYXBwZXIsIFt7XG4gICAga2V5OiAncmVuZGVyJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgcmV0dXJuIFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICdkaXYnLFxuICAgICAgICBudWxsLFxuICAgICAgICB0aGlzLnByb3BzLmNoaWxkcmVuXG4gICAgICApO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBXcmFwcGVyO1xufShSZWFjdC5Db21wb25lbnQpO1xuXG5kZXNjcmliZSgnRmlzaFRhYmxlJywgZnVuY3Rpb24gKCkge1xuXG4gIGl0KCdzaG91bGQgcmVuZGVyIG5vIGBGaXNoVGFibGVSb3dgIHdoZW4gZ2l2ZW4gemVybyBmaXNoJywgZnVuY3Rpb24gKCkge1xuICAgIC8vIFRoZSBXcmFwZXIgYWxsb3dzIHVzIHRvIHNjcnkgZm9yIGNvbXBvbmVudHNcbiAgICB2YXIgZmlzaFRhYmxlID0gUmVhY3QuYWRkb25zLlRlc3RVdGlscy5yZW5kZXJJbnRvRG9jdW1lbnQoUmVhY3QuY3JlYXRlRWxlbWVudChcbiAgICAgIFdyYXBwZXIsXG4gICAgICBudWxsLFxuICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChGaXNoVGFibGUsIHsgZmlzaGVzOiBbXSB9KVxuICAgICkpO1xuXG4gICAgdmFyIGZpc2hUYWJsZVJvd3MgPSBSZWFjdC5hZGRvbnMuVGVzdFV0aWxzLnNjcnlSZW5kZXJlZENvbXBvbmVudHNXaXRoVHlwZShmaXNoVGFibGUsIEZpc2hUYWJsZVJvdyk7XG4gICAgZmlzaFRhYmxlUm93cy5zaG91bGQuaGF2ZS5sZW5ndGgoMCk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgcmVuZGVyIG9uZSBgRmlzaFRhYmxlUm93YCB3aGVuIGdpdmVuIG9uZSBmaXNoJywgZnVuY3Rpb24gKCkge1xuICAgIHZhciBmaXNoRGF0YSA9IFt7XG4gICAgICBuYW1lOiAnR29sZGZpc2gnLFxuICAgICAgaW1hZ2U6ICdodHRwOi8vdGlueXVybC5jb20vbjR2Z2NsNScsXG4gICAgICBkZXNjcmlwdGlvbjogJ0V2ZXJ5b25lXFwncyBmaXJzdCBwZXQnXG4gICAgfV07XG5cbiAgICAvLyBUaGUgV3JhcGVyIGFsbG93cyB1cyB0byBzY3J5IGZvciBjb21wb25lbnRzXG4gICAgdmFyIGZpc2hUYWJsZSA9IFJlYWN0LmFkZG9ucy5UZXN0VXRpbHMucmVuZGVySW50b0RvY3VtZW50KFJlYWN0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICBXcmFwcGVyLFxuICAgICAgbnVsbCxcbiAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoRmlzaFRhYmxlLCB7IGZpc2hlczogZmlzaERhdGEgfSlcbiAgICApKTtcblxuICAgIHZhciBmaXNoVGFibGVSb3dzID0gUmVhY3QuYWRkb25zLlRlc3RVdGlscy5zY3J5UmVuZGVyZWRDb21wb25lbnRzV2l0aFR5cGUoZmlzaFRhYmxlLCBGaXNoVGFibGVSb3cpO1xuICAgIGZpc2hUYWJsZVJvd3Muc2hvdWxkLmhhdmUubGVuZ3RoKDEpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHJlbmRlciB0aHJlZSBgRmlzaFRhYmxlUm93YCB3aGVuIGdpdmVuIHRocmVlIGZpc2hlcycsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZmlzaERhdGEgPSBbe1xuICAgICAgbmFtZTogJ0dvbGRmaXNoJyxcbiAgICAgIGltYWdlOiAnaHR0cDovL3Rpbnl1cmwuY29tL240dmdjbDUnLFxuICAgICAgZGVzY3JpcHRpb246ICdFdmVyeW9uZVxcJ3MgZmlyc3QgcGV0J1xuICAgIH0sIHtcbiAgICAgIG5hbWU6ICdQdWZmZXJmaXNoJyxcbiAgICAgIGltYWdlOiAnaHR0cDovL3Rpbnl1cmwuY29tL2t4ZDdjdXUnLFxuICAgICAgZGVzY3JpcHRpb246ICdTbyBwdWZmeSEnXG4gICAgfSwge1xuICAgICAgbmFtZTogJ1R1bmEnLFxuICAgICAgaW1hZ2U6ICdodHRwOi8vdGlueXVybC5jb20vemdzN3oycycsXG4gICAgICBkZXNjcmlwdGlvbjogJ1doeSBhcmUgdGhlc2UgdGhpbmdzIHNvIGh1Z2U/IFRIZXlcXCdyZSB0ZXJyaWZ5aW5nLidcbiAgICB9XTtcblxuICAgIC8vIFRoZSBXcmFwZXIgYWxsb3dzIHVzIHRvIHNjcnkgZm9yIGNvbXBvbmVudHNcbiAgICB2YXIgZmlzaFRhYmxlID0gUmVhY3QuYWRkb25zLlRlc3RVdGlscy5yZW5kZXJJbnRvRG9jdW1lbnQoUmVhY3QuY3JlYXRlRWxlbWVudChcbiAgICAgIFdyYXBwZXIsXG4gICAgICBudWxsLFxuICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChGaXNoVGFibGUsIHsgZmlzaGVzOiBmaXNoRGF0YSB9KVxuICAgICkpO1xuXG4gICAgdmFyIGZpc2hUYWJsZVJvd3MgPSBSZWFjdC5hZGRvbnMuVGVzdFV0aWxzLnNjcnlSZW5kZXJlZENvbXBvbmVudHNXaXRoVHlwZShmaXNoVGFibGUsIEZpc2hUYWJsZVJvdyk7XG4gICAgZmlzaFRhYmxlUm93cy5zaG91bGQuaGF2ZS5sZW5ndGgoMyk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdGaXNoVGFibGVSb3cnLCBmdW5jdGlvbiAoKSB7XG4gIGl0KCdzaG91bGQgcmVuZGVyIGEgZHluYW1pYyBuYW1lJywgZnVuY3Rpb24gKCkge1xuICAgIHZhciBibG9iYmVydCA9IHtcbiAgICAgIG5hbWU6ICdCbG9iYmVydCcsXG4gICAgICBpbWFnZTogJ2h0dHA6Ly90aW55dXJsLmNvbS9oZmhvbmhjJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnVGhlIHNhZGRlc3QgYmxvYiBvZiBhIGZpc2ggeW91IGhhdmUgZXZlciBzZWVuJ1xuICAgIH07XG5cbiAgICB2YXIgZmlzaFRhYmxlUm93ID0gUmVhY3RET00ucmVuZGVyKFJlYWN0LmNyZWF0ZUVsZW1lbnQoRmlzaFRhYmxlUm93LCB7IGZpc2g6IGJsb2JiZXJ0IH0pLCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0Ym9keScpKTtcblxuICAgIHZhciBuYW1lID0gUmVhY3QuYWRkb25zLlRlc3RVdGlscy5maW5kUmVuZGVyZWRET01Db21wb25lbnRXaXRoQ2xhc3MoZmlzaFRhYmxlUm93LCAnZmlzaC1uYW1lJyk7XG4gICAgbmFtZS5pbm5lclRleHQuc2hvdWxkLmVxdWFsKCdCbG9iYmVydCcpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHJlbmRlciBhIGR5bmFtaWMgaW1hZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGJsb2JiZXJ0ID0ge1xuICAgICAgbmFtZTogJ0Jsb2JiZXJ0JyxcbiAgICAgIGltYWdlOiAnaHR0cDovL3Rpbnl1cmwuY29tL2hmaG9uaGMnLFxuICAgICAgZGVzY3JpcHRpb246ICdUaGUgc2FkZGVzdCBibG9iIG9mIGEgZmlzaCB5b3UgaGF2ZSBldmVyIHNlZW4nXG4gICAgfTtcblxuICAgIHZhciBmaXNoVGFibGVSb3cgPSBSZWFjdERPTS5yZW5kZXIoUmVhY3QuY3JlYXRlRWxlbWVudChGaXNoVGFibGVSb3csIHsgZmlzaDogYmxvYmJlcnQgfSksIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3Rib2R5JykpO1xuXG4gICAgdmFyIGltYWdlID0gUmVhY3QuYWRkb25zLlRlc3RVdGlscy5maW5kUmVuZGVyZWRET01Db21wb25lbnRXaXRoVGFnKGZpc2hUYWJsZVJvdywgJ2ltZycpO1xuICAgIGltYWdlLnNyYy5zaG91bGQuZXF1YWwoJ2h0dHA6Ly90aW55dXJsLmNvbS9oZmhvbmhjJyk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgcmVuZGVyIGEgZHluYW1pYyBkZXNjcmlwdGlvbicsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYmxvYmJlcnQgPSB7XG4gICAgICBuYW1lOiAnQmxvYmJlcnQnLFxuICAgICAgaW1hZ2U6ICdodHRwOi8vdGlueXVybC5jb20vaGZob25oYycsXG4gICAgICBkZXNjcmlwdGlvbjogJ1RoZSBzYWRkZXN0IGJsb2Igb2YgYSBmaXNoIHlvdSBoYXZlIGV2ZXIgc2VlbidcbiAgICB9O1xuXG4gICAgdmFyIGZpc2hUYWJsZVJvdyA9IFJlYWN0RE9NLnJlbmRlcihSZWFjdC5jcmVhdGVFbGVtZW50KEZpc2hUYWJsZVJvdywgeyBmaXNoOiBibG9iYmVydCB9KSwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGJvZHknKSk7XG5cbiAgICAvLyBUb2dnbGUgZGVzY3JpcHRpb24gb24gYmVmb3JlIHdlIHNlYXJjaCBmb3IgaXRcbiAgICBmaXNoVGFibGVSb3cuc2V0U3RhdGUoeyBzaG93RGVzY3JpcHRpb246IHRydWUgfSk7XG5cbiAgICB2YXIgZGVzY3JpcHRpb24gPSBSZWFjdC5hZGRvbnMuVGVzdFV0aWxzLmZpbmRSZW5kZXJlZERPTUNvbXBvbmVudFdpdGhDbGFzcyhmaXNoVGFibGVSb3csICdmaXNoLWRlc2NyaXB0aW9uJyk7XG4gICAgZGVzY3JpcHRpb24uaW5uZXJUZXh0LnNob3VsZC5lcXVhbCgnVGhlIHNhZGRlc3QgYmxvYiBvZiBhIGZpc2ggeW91IGhhdmUgZXZlciBzZWVuJyk7XG4gIH0pO1xufSk7XG4iXX0=